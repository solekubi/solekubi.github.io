import{u as useConfigStore}from"./config-DZfX7e1e.js";import{t as defineStore,r as ref,a as reactive,_ as _export_sfc,s as storeToRefs,c as createBlock,w as withCtx,h as router,v as ElPageHeader,o as openBlock,g as createBaseVNode,x as toDisplayString,u as unref,e as createElementBlock,f as renderList,F as Fragment,d as createVNode,b as createTextVNode,y as isRef,n as ElButton,z as ElCountdown,A as ElRate,B as ElDialog,C as check_default,D as ElTag,m as ElInput,G as ElCol,H as ElRow}from"./index-DYbMz_hb.js";const useAppStore=defineStore("app",()=>{const isComplete=ref(!1),countDown=reactive({start:0,end:0}),score=ref(3),calcList=ref([]),setComplete=e=>{isComplete.value=e},setCountDown=e=>{const o=Date.now();countDown.start=o,countDown.end=countDown.start+1e3*60*(e??0)},setScore=(e,o)=>{score.value=Number((e/o*5).toFixed(2))},setCalcList=(val,ops,bit,cnt)=>{calcList.value=Array.from({length:cnt},(_,idx)=>{const numbers=Array.from({length:val},(e,o)=>o+1);let params=Array.from({length:bit},()=>numbers[Math.floor(Math.random()*numbers.length)]),formula=params.reduce((e,o)=>`${e} ${ops[Math.floor(Math.random()*ops.length)]} ${o}`),value=eval(formula);for(;value<0||value>val||calcList.value.map(e=>e.formula).includes(formula);)params=Array.from({length:bit},()=>numbers[Math.floor(Math.random()*numbers.length)]),formula=params.reduce((e,o)=>`${e} ${ops[Math.floor(Math.random()*ops.length)]} ${o}`),value=eval(formula);return{id:idx+1,formula,value:void 0}})};return{isComplete,score,countDown,calcList,setCalcList,setComplete,setCountDown,setScore}}),_hoisted_1={class:"flex"},_hoisted_2={class:"text-large font-600 mr-3"},_hoisted_3={class:"flex",style:{"padding-top":"5px"}},_hoisted_4={style:{width:"50px"}},_hoisted_5={class:"dialog-score"},_hoisted_6={class:"demonstration"},_hoisted_7={class:"dialog-score"},_sfc_main={__name:"PageView",setup(__props){var e,o;const appStore=useAppStore(),{configs}=useConfigStore(),{score,countDown,calcList}=storeToRefs(appStore),title=(e=configs.type)==null?void 0:e.label;appStore.setCountDown(configs.cnt),appStore.setCalcList(configs.type.value??0,(o=configs.schema)==null?void 0:o.map(l=>l.value),configs.bit.value??2,configs.cnt??0);const goBack=()=>{router.back()},showScore=ref(!1),correct=ref(0),handleSubmit=()=>{correct.value=0;for(const{formula,value}of calcList.value)eval(formula)==Number(value)&&correct.value++;appStore.setScore(correct.value,configs.cnt),showScore.value=!0},doFinish=()=>{};return(l,a)=>{const r=ElTag,n=ElButton,c=ElCountdown,i=ElInput,u=ElCol,d=ElRow,p=ElRate,f=ElDialog,m=ElPageHeader;return openBlock(),createBlock(m,{title:"返回",onBack:a[3]||(a[3]=t=>goBack())},{content:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createBaseVNode("span",_hoisted_2,toDisplayString(unref(title)),1),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(configs).schema,(t,s)=>(openBlock(),createBlock(r,{style:{margin:"2px"},size:"small",key:t,type:s==0?"success":"danger"},{default:withCtx(()=>[createTextVNode(toDisplayString(t.label),1)]),_:2},1032,["type"]))),128))])]),extra:withCtx(()=>[createVNode(c,{format:"mm:ss",value:unref(countDown).end,onFinish:doFinish},{suffix:withCtx(()=>[createVNode(n,{size:"small",type:"primary",class:"ml-2",onClick:handleSubmit},{default:withCtx(()=>[createTextVNode("提交")]),_:1})]),_:1},8,["value"])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_3,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(calcList),t=>(openBlock(),createBlock(d,{gutter:20,key:t.id,style:{"padding-bottom":"5px"}},{default:withCtx(()=>[createVNode(u,null,{default:withCtx(()=>[createVNode(i,{modelValue:t.value,"onUpdate:modelValue":s=>t.value=s},{prepend:withCtx(()=>[createBaseVNode("span",_hoisted_4,toDisplayString(t.formula),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),createVNode(f,{modelValue:showScore.value,"onUpdate:modelValue":a[2]||(a[2]=t=>showScore.value=t),"align-center":"","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_7,[createVNode(n,{type:"success",icon:unref(check_default),circle:"",onClick:a[1]||(a[1]=t=>showScore.value=!1)},null,8,["icon"])])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_5,[createBaseVNode("span",_hoisted_6,toDisplayString(correct.value)+" / "+toDisplayString(unref(configs).cnt),1),createVNode(p,{size:"large",modelValue:unref(score),"onUpdate:modelValue":a[0]||(a[0]=t=>isRef(score)?score.value=t:null),"allow-half":"",disabled:""},null,8,["modelValue"])])]),_:1},8,["modelValue"])]),_:1})}}},PageView=_export_sfc(_sfc_main,[["__scopeId","data-v-f67eb041"]]);export{PageView as default};
