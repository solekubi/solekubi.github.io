import{u as useConfigStore}from"./config-DK5UhbqJ.js";import{A as defineStore,r as ref,a as reactive,_ as _export_sfc,s as storeToRefs,B as computed,e as createElementBlock,z as createBaseVNode,b as createVNode,w as withCtx,u as unref,F as Fragment,f as renderList,g as router,t as ElButton,C as ElCountdown,D as ElProgress,G as ElDialog,o as openBlock,d as createTextVNode,H as back_default,I as toDisplayString,J as check_default,K as ElDivider,L as ElTag,n as ElInput,M as ElRate}from"./index-D3aXsYiS.js";const useAppStore=defineStore("app",()=>{const isComplete=ref(!1),countDown=reactive({start:0,end:0}),calcList=ref([]),setComplete=e=>{isComplete.value=e},setCountDown=e=>{const o=Date.now();countDown.start=o,countDown.end=countDown.start+1e3*60*(e??0)},setCalcList=(val,ops,bit,cnt)=>{calcList.value=Array.from({length:cnt},(_,idx)=>{const numbers=Array.from({length:val},(e,o)=>o+1);let params=Array.from({length:bit},()=>numbers[Math.floor(Math.random()*numbers.length)]),formula=params.reduce((e,o)=>`${e} ${ops[Math.floor(Math.random()*ops.length)]} ${o}`),value=eval(formula);for(;value<0||value>val||calcList.value.map(e=>e.formula).includes(formula);)params=Array.from({length:bit},()=>numbers[Math.floor(Math.random()*numbers.length)]),formula=params.reduce((e,o)=>`${e} ${ops[Math.floor(Math.random()*ops.length)]} ${o}`),value=eval(formula);return{id:idx+1,formula,value:void 0}})};return{isComplete,countDown,calcList,setCalcList,setComplete,setCountDown}}),_hoisted_1={class:"container"},_hoisted_2={class:"header"},_hoisted_3={class:"header__left"},_hoisted_4={class:"header__mid"},_hoisted_5={class:"header__right"},_hoisted_6={class:"body"},_hoisted_7={class:"dialog-score"},_hoisted_8={class:"demonstration"},_hoisted_9={class:"dialog-score"},_sfc_main={__name:"PageView",setup(__props){var e;const appStore=useAppStore(),{configs}=useConfigStore(),{countDown,calcList}=storeToRefs(appStore);appStore.setCountDown(configs.cnt),appStore.setCalcList(configs.type.value??0,(e=configs.schema)==null?void 0:e.map(o=>o.value),configs.bit.value??2,configs.cnt??0);const goBack=()=>{router.push({path:"/"})},showScore=ref(!1),correct=ref(0),score=computed(()=>Number((correct.value/configs.cnt*5).toFixed(2))),handleSubmit=()=>{correct.value=0,showScore.value=!0;for(const{formula,value}of calcList.value)eval(formula)==Number(value)&&++correct.value},colors=[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#5cb87a",percentage:60},{color:"#1989fa",percentage:80},{color:"#6f7ad3",percentage:100}],percentage=computed(()=>{let o=0;for(const{value:t}of calcList.value)typeof t<"u"&&String(t).replace(/\s+/g,"")!==""&&o++;return Math.round(o/configs.cnt*100)}),doFinish=()=>{};return(o,t)=>{const s=ElButton,l=ElCountdown,n=ElProgress,c=ElDivider,r=ElTag,i=ElInput,d=ElRate,u=ElDialog;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createVNode(s,{icon:unref(back_default),link:"",size:"large",onClick:goBack},{default:withCtx(()=>[createTextVNode("返回")]),_:1},8,["icon"])]),createBaseVNode("div",_hoisted_4,[createVNode(l,{format:"mm:ss",value:unref(countDown).end,onFinish:doFinish},null,8,["value"])]),createBaseVNode("div",_hoisted_5,[createVNode(n,{type:"circle",indeterminate:"",percentage:percentage.value,color:colors,width:50},null,8,["percentage"]),createVNode(s,{size:"small",type:"warning",onClick:handleSubmit,round:""},{default:withCtx(()=>[createTextVNode("提交")]),_:1})])]),createVNode(c,{style:{margin:"12px 0"}}),createBaseVNode("div",_hoisted_6,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(calcList),a=>(openBlock(),createElementBlock("div",{class:"body_item",key:a.id},[createVNode(r,{class:"header__body_item_left",type:"primary"},{default:withCtx(()=>[createTextVNode(toDisplayString(a.formula+" ="),1)]),_:2},1024),createVNode(i,{class:"header__body_item_right",type:"number",size:"small","controls-position":"right",modelValue:a.value,"onUpdate:modelValue":p=>a.value=p},null,8,["modelValue","onUpdate:modelValue"])]))),128))])]),createVNode(u,{modelValue:showScore.value,"onUpdate:modelValue":t[2]||(t[2]=a=>showScore.value=a),"align-center":"","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_9,[createVNode(s,{type:"success",icon:unref(check_default),circle:"",onClick:t[1]||(t[1]=a=>showScore.value=!1)},null,8,["icon"])])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_7,[createBaseVNode("span",_hoisted_8,toDisplayString(correct.value)+" / "+toDisplayString(unref(configs).cnt),1),createVNode(d,{size:"large",modelValue:score.value,"onUpdate:modelValue":t[0]||(t[0]=a=>score.value=a),"allow-half":"",disabled:""},null,8,["modelValue"])])]),_:1},8,["modelValue"])],64)}}},PageView=_export_sfc(_sfc_main,[["__scopeId","data-v-1429e256"]]);export{PageView as default};
